"use strict";(self.webpackChunkperidio_docs=self.webpackChunkperidio_docs||[]).push([[5210],{58084:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var t=n(74848),a=n(28453);const s={},o="Direct API integration",r={id:"integration/android/reference-designs/direct-api-integration",title:"Direct API integration",description:"Direct Device API integration of Android devices with Peridio involves the following:",source:"@site/docs/integration/android/reference-designs/direct-api-integration.md",sourceDirName:"integration/android/reference-designs",slug:"/integration/android/reference-designs/direct-api-integration",permalink:"/integration/android/reference-designs/direct-api-integration",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"integration",previous:{title:"Overview",permalink:"/integration/android/overview"},next:{title:"Overview",permalink:"/integration/linux/overview"}},l={},d=[{value:"Authentication",id:"authentication",level:2},{value:"Discover updates",id:"discover-updates",level:2},{value:"Download updates",id:"download-updates",level:2},{value:"Fast downloads",id:"fast-downloads",level:3},{value:"Parallel downloads",id:"parallel-downloads",level:4},{value:"Resumable downloads",id:"resumable-downloads",level:4},{value:"Install updates",id:"install-updates",level:2},{value:"Optional extensions",id:"optional-extensions",level:2},{value:"Remote access tunnels",id:"remote-access-tunnels",level:3}];function c(e){const i={a:"a",admonition:"admonition",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"direct-api-integration",children:"Direct API integration"}),"\n",(0,t.jsxs)(i.p,{children:["Direct ",(0,t.jsx)(i.a,{href:"/device-api",children:"Device API"})," integration of Android devices with Peridio involves the following:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Authentication"}),"\n",(0,t.jsx)(i.li,{children:"Discover updates"}),"\n",(0,t.jsx)(i.li,{children:"Download updates"}),"\n",(0,t.jsx)(i.li,{children:"Install updates"}),"\n",(0,t.jsx)(i.li,{children:"Optional extensions"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"authentication",children:"Authentication"}),"\n",(0,t.jsx)(i.p,{children:"Devices authenticate to the Device API via mutual TLS (mTLS), sometimes referred to as mutual authentication. That is, where TLS typically requires the client to verify the server, mTLS requires the client and the server to verify eachother. mTLS is an industry standard variation of transport layer security and is not a Peridio-specific concept. For example, AWS IoT Core uses mTLS. This standardization allows devices to connect to a variety of systems using the same credentials in the same way, simplifying integration while ensuring security."}),"\n",(0,t.jsxs)(i.p,{children:["In the context of Android, this requires that your devices have a device-specific identity that is\nattestable via an X.509 v3 certificate, hereafter refered to as a ",(0,t.jsx)(i.a,{href:"/platform/reference/device-certificates",children:"device certificate"}),". The device certificate must be stored on device in a manner that persists in all cases, e.g., across reboots, updates, and factory resets."]}),"\n",(0,t.jsx)(i.admonition,{title:"mutable identities",type:"info",children:(0,t.jsx)(i.p,{children:"There are exceptional scenarios where one may desire the ability to mutate (delete or reset) a device's identity, which is to say delete or reset the device certificate. Such scenarios are outside the scope of this document."})}),"\n",(0,t.jsxs)(i.p,{children:["The device certificate is then supplied when making requests to the Device API as part of mutual authentication. How exactly this manifests in code is dependent on the client HTTP library you use. For example, when using retrofit/okhttp, reference their ",(0,t.jsx)(i.a,{href:"https://github.com/square/okhttp/blob/master/okhttp-tls/README.md?utm_source=chatgpt.com#client-authentication",children:"client authentication"})," documentation."]}),"\n",(0,t.jsx)(i.p,{children:"A device correctly supplying its certificate is half of the effort, the server must also know to trust the client's certificate. This can be can be achieved in a couple of ways:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["The CLI's ",(0,t.jsx)(i.a,{href:"/cli/device-certificates/create",children:"device-certificates create"})," command.","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Typically used in ad-hoc development contexts."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["The Admin API's ",(0,t.jsx)(i.a,{href:"/admin-api#device-certificates/operation/create-a-device-certificate",children:"create-a-device-certificate"})," route.","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Typically used in ad-hoc production contexts."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.a,{href:"/platform/reference/just-in-time-provisioning",children:"Just-in-time provisioning"}),".","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Typically used in mass-manufacturing production contexts."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"discover-updates",children:"Discover updates"}),"\n",(0,t.jsxs)(i.p,{children:["Device's may check if an update is available by hitting the Device API ",(0,t.jsx)(i.a,{href:"/device-api#devices/operation/get-update",children:"get-update"})," route. This will inform them of if an update is available, as well as provide pre-signed download URLs for each of the bundle's binaries. Interaction with this API is also how the device informs Peridio of its current status, i.e., what release/bundle/version it is currently running."]}),"\n",(0,t.jsx)(i.h2,{id:"download-updates",children:"Download updates"}),"\n",(0,t.jsx)(i.p,{children:"After a device learns an update is available, it is free to download none, some, or all of the available binaries as it deems fit. This decision is as simple or complex as the use case demands, ranging from always downloading immediately when available, to potentially involving custom metadata configured into Peridio, environmental and operational factors like time of day and system status, and even local human operator input."}),"\n",(0,t.jsx)(i.p,{children:"In any case, it is important to consider:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"How the download is performed."}),"\n",(0,t.jsx)(i.li,{children:"Where the content is downloaded to."}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"fast-downloads",children:"Fast downloads"}),"\n",(0,t.jsx)(i.p,{children:'Pending the size of your binaries and your operational requirements, it is common to desire "fast downloads". This effectively translates to parallel resumable downloads.'}),"\n",(0,t.jsx)(i.h4,{id:"parallel-downloads",children:"Parallel downloads"}),"\n",(0,t.jsx)(i.p,{children:"Parallel downloads involve splitting the binary into smaller chunks and downloading these chunks concurrently using multiple network connections. This approach can significantly improve download speeds, especially in high-bandwidth or low-latency environments, by maximizing network throughput and minimizing the impact of slow segments. Implementing parallel downloads requires support for HTTP range requests, which Peridio supports, and careful management of concurrent streams to avoid overwhelming the device's network stack or storage subsystem. For Android, leveraging libraries like OkHttp with custom interceptors can simplify this implementation."}),"\n",(0,t.jsx)(i.h4,{id:"resumable-downloads",children:"Resumable downloads"}),"\n",(0,t.jsx)(i.p,{children:"Resumable downloads ensure that a download interrupted by network issues, device reboots, or other disruptions can continue from where it left off, rather than restarting from the beginning. This feature is particularly important for large binaries or devices operating in unreliable network conditions. Resumable downloads typically rely on HTTP range requests and metadata tracking to store the progress of each chunk. On Android, this can be achieved by managing state in local storage and using libraries or APIs that support partial downloads, ensuring seamless recovery and efficient use of bandwidth."}),"\n",(0,t.jsx)(i.h2,{id:"install-updates",children:"Install updates"}),"\n",(0,t.jsx)(i.p,{children:"After a binary is downloaded, how you install it depends on what the binary is as well as your wider platform context. For apps you may handoff to the Package Installer API. For system updates you may handoff to the Update Engine API. For other artifact types, installation may simply be persisting the binary to a particular location."}),"\n",(0,t.jsx)(i.h2,{id:"optional-extensions",children:"Optional extensions"}),"\n",(0,t.jsx)(i.p,{children:"Beyond OTA and connectivity information described earlier, there are other categories of functionality you may wish to optionally leverage."}),"\n",(0,t.jsx)(i.h3,{id:"remote-access-tunnels",children:"Remote access tunnels"}),"\n",(0,t.jsx)(i.p,{children:"Peridio supports remote access tunnels, that is, secure wireguard connections with your device. From the device's perspective these connections are outbound-initiated, so no inbound ports are required for initiation of the tunnel. The effort to support these tunnels is primarily ensuring wireguard is available on-device, either as a kernel module or a user-space implementation. Beyond that, the device must integrate with the Peridio Device WS API to support control plane operations of this functionality like discovering a tunnel is desired as well as exchanging network configuration handshakes."}),"\n",(0,t.jsx)(i.p,{children:"For integration support for remote access tunnels, please contact our support team."})]})}function h(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>o,x:()=>r});var t=n(96540);const a={},s=t.createContext(a);function o(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);