"use strict";(self.webpackChunkparasola=self.webpackChunkparasola||[]).push([[4759],{95160:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>o});var n=i(74848),a=i(28453);const r={title:"Deployments"},s=void 0,d={id:"reference/deployments",title:"Deployments",description:"This functionality has been superceded by bundles and releases.",source:"@site/docs/reference/deployments.md",sourceDirName:"reference",slug:"/reference/deployments",permalink:"/reference/deployments",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Deployments"},sidebar:"reference",previous:{title:"Bundles",permalink:"/reference/bundles"},next:{title:"Releases",permalink:"/reference/releases"}},l={},o=[{value:"Deployment eligibility",id:"deployment-eligibility",level:2},{value:"Tags",id:"tags",level:3},{value:"Version",id:"version",level:3},{value:"Quarantine",id:"quarantine",level:2},{value:"Failure rates and thresholds",id:"failure-rates-and-thresholds",level:2},{value:"Automatically quarantine deployments",id:"automatically-quarantine-deployments",level:3},{value:"Automatically quarantine devices",id:"automatically-quarantine-devices",level:3},{value:"Clear failure rates and thresholds",id:"clear-failure-rates-and-thresholds",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.admonition,{title:"Legacy",type:"info",children:(0,n.jsxs)(t.p,{children:["This functionality has been superceded by ",(0,n.jsx)(t.a,{href:"bundles",children:"bundles"})," and ",(0,n.jsx)(t.a,{href:"releases",children:"releases"}),"."]})}),"\n",(0,n.jsxs)(t.p,{children:["A deployment makes ",(0,n.jsx)(t.a,{href:"firmware",children:"firmware"})," conditionally available to ",(0,n.jsx)(t.a,{href:"devices",children:"devices"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"deployment-eligibility",children:"Deployment eligibility"}),"\n",(0,n.jsxs)(t.p,{children:["When a device checks for an update with ",(0,n.jsx)(t.a,{href:"/device-api#devices/operation/get-device-update",children:"get-device-update"}),", Peridio resolves which deployment, if any, is applicable to the requesting device, which dictates which firmware Peridio will respond to the request with."]}),"\n",(0,n.jsx)(t.p,{children:"For a device to be eligible for a particular deployment, the following conditions must be met:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The deployment is active."}),"\n",(0,n.jsx)(t.li,{children:"The deployment and the device are not quarantined and belong to the same organization and product."}),"\n",(0,n.jsx)(t.li,{children:"The device must have at least the tags the deployment's conditions specify."}),"\n",(0,n.jsx)(t.li,{children:"If the deployment has a version condition, the device's firmware's version must satisfy it."}),"\n",(0,n.jsx)(t.li,{children:"The device's firmware and the deployment's firmware have matching architecture and platforms, but distinct UUIDs."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["Peridio tracks metadata about the current firmware of devices. Devices dictate what Peridio considers their current firmware by supplying ",(0,n.jsxs)(t.a,{href:"/device-api#section/Global-Headers",children:[(0,n.jsx)(t.code,{children:"x-peridio"})," headers"]})," to the Peridio Device API."]}),"\n",(0,n.jsx)(t.h3,{id:"tags",children:"Tags"}),"\n",(0,n.jsx)(t.p,{children:"A deployment must specify at least one tag as a condition. A device must have at least all of the tags specified by the deployment in order to meet the condition."}),"\n",(0,n.jsx)(t.h3,{id:"version",children:"Version"}),"\n",(0,n.jsxs)(t.p,{children:["A deployment may optionally specify a SemVer version requirement. When specified, a device's firmware's version must satisfy the requirement. Firmware versions are ",(0,n.jsx)(t.a,{href:"https://semver.org/spec/v2.0.0.html",children:"semantic versions"}),", for examples of what a version condition on a deployment may look like, reference ",(0,n.jsx)(t.a,{href:"https://hexdocs.pm/elixir/Version.html#module-requirements",children:"https://hexdocs.pm/elixir/Version.html#module-requirements"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"quarantine",children:"Quarantine"}),"\n",(0,n.jsxs)(t.p,{children:["Deployment's have a boolean ",(0,n.jsx)(t.code,{children:"quarantined"})," field. When ",(0,n.jsx)(t.code,{children:"true"}),", the deployment will not serve updates. Deployments can be automatically quarantined due to failure rate and failure threshold configurations."]}),"\n",(0,n.jsx)(t.h2,{id:"failure-rates-and-thresholds",children:"Failure rates and thresholds"}),"\n",(0,n.jsxs)(t.p,{children:["Deployments allow you to configure failure rates and thresholds such that devices and deployments can be quarantined automatically in reaction to devices repeatedly asking for the same update from the same deployment via ",(0,n.jsx)(t.a,{href:"/device-api#devices/operation/get-device-update",children:"get-device-update"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"automatically-quarantine-deployments",children:"Automatically quarantine deployments"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Field"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Failure rate"}),(0,n.jsx)(t.td,{children:"How many devices can have asked 2 or more times each for the same update from the same deployment within failure rate seconds before the deployment is automatically quarantined."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Failure rate seconds"}),(0,n.jsx)(t.td,{children:"The duration to use with failure rate."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Failure threshold"}),(0,n.jsx)(t.td,{children:"How many devices with firmware metadata whose architecture, platform, product, and uuid match that of the deployment's firmware that can be simultaneously quarantined before the deployment is automatically quarantined."})]})]})]}),"\n",(0,n.jsx)(t.h3,{id:"automatically-quarantine-devices",children:"Automatically quarantine devices"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Field"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Device failure rate"}),(0,n.jsx)(t.td,{children:"How many times a device can have asked for the same update from the same deployment within device failure rate seconds before the device is automatically quarantined."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Device failure rate seconds"}),(0,n.jsx)(t.td,{children:"The duration to use with device failure rate."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Device Failure threshold"}),(0,n.jsx)(t.td,{children:"How many times total a device can have asked for the same update from the same deployment before the device is automatically quarantined."})]})]})]}),"\n",(0,n.jsx)(t.h3,{id:"clear-failure-rates-and-thresholds",children:"Clear failure rates and thresholds"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Unquarantining a deployment will cause device update attempts prior to that to be ignored in failure rates and thresholds."}),"\n",(0,n.jsx)(t.li,{children:"Unquarantining a device will cause its update attempts prior to that to be ignored in failure rates and thresholds."}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"/admin-api#device-events/operation/device-release-changed",children:(0,n.jsx)(t.code,{children:"device.release_changed"})})," and ",(0,n.jsx)(t.a,{href:"/admin-api#device-events/operation/device-firmware-changed",children:(0,n.jsx)(t.code,{children:"device.firmware_changed"})})," events cause update attempts prior to them to be ignored in failure rates and thresholds."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>d});var n=i(96540);const a={},r=n.createContext(a);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);